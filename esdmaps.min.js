!function(a,b){"undefined"!=typeof exports?b(a,exports,null):a.ESDMaps=b(a,a.ESDMaps||{},a.L)}(this,function(a,b,c){function d(a,b){for(var c=0;c<a.length;c++)b(a[c],c)}function e(a){return d(Array.prototype.slice.call(arguments,1),function(b){for(var c in b)void 0===a[c]&&(a[c]=b[c])}),a}function f(a,b){var c={};return d(b,function(b){a[b]&&(c[b]=a[b])}),c}function g(a,b,c){var d=new XMLHttpRequest;d.open("GET",a,!0),d.onreadystatechange=function(){4===this.readyState&&(this.status>=200&&this.status<400?b(JSON.parse(this.responseText)):c&&c())},d.send(),d=null}function h(a,b){var c={};return d(b,function(b){var d="data-"+b;a.hasAttribute(d)&&(c[b]=a.getAttribute(d))}),c}function i(a,b){a.classList?a.classList.add(b):a.className+=" "+b}function j(a,b){a.classList?a.classList.remove(b):a.className=a.className.replace(new RegExp("(^|\\b)"+b.split(" ").join("|")+"(\\b|$)","gi")," ")}function k(a,b){var c;"undefined"==typeof b.altPopup?(c=o(),container=a.getContainer(),container.parentNode.insertBefore(c,container.nextSibling)):c="string"==typeof b.altPopup?document.querySelector("#"+b.altPopup):b.altPopup,c&&(i(c,q.altPopupClass),a.on("popupopen",function(a){c.innerHTML=a.popup.getContent(),i(c,q.altPopupOpenClass)}),a.on("popupclose",function(){c.innerHTML="",j(c,q.altPopupOpenClass)}))}function l(a,b,d){return g(b,function(b){c.geoJson(b,{pointToLayer:c.mapbox.marker.style,style:function(a){return a.properties},onEachFeature:function(a,b){b.bindPopup(n(d.popupTemplate,a.properties)),b.on("popupopen",function(a){var b=a.target;b.feature.properties["old-color"]=b.feature.properties["marker-color"],b.feature.properties["marker-color"]=q.selectedMarkerColor,b.setIcon(c.mapbox.marker.icon(b.feature.properties))}),b.on("popupclose",function(a){var b=a.target;b.feature.properties["marker-color"]=b.feature.properties["old-color"],b.setIcon(c.mapbox.marker.icon(b.feature.properties))}),d.showPopupOnHover&&m(b,d)}}).addTo(a)}),a}function m(a,b){a.on("mouseover",function(a){var c=a.target.getPopup();a.target._hovering=!0,c.setContent(n(b.hoverPopupTemplate,a.target.feature.properties)),a.target.openPopup()}),a.on("mouseout",function(a){a.target._hovering&&(a.target._hovering=!1,a.target.closePopup())}),a.on("click",function(a){var c;a.target._hovering&&(c=a.target.getPopup(),a.target._hovering=!1,c.setContent(n(b.popupTemplate,a.target.feature.properties)),a.target.openPopup())})}function n(a,b){return"string"==typeof a?c.mapbox.template(a,b):"function"==typeof a?a(b):""}function o(){var a=document.createElement("div");return a.setAttribute("id","esdmaps-alt-popup"),a}function p(a){var d,e=h(a,["preset","alt-popup","points-url","zoom","center"]);e.center&&(d=e.center.split(","),e.center=c.latLng(parseFloat(d[0]),parseFloat(d[1]))),b.map(a,e.preset,{altPopup:e["alt-popup"],pointsUrl:e["points-url"],zoom:e.zoom,center:e.center})}b.VERSION="0.0.1";var q=b.settings={mapboxId:"esd.ExcellentSchoolsDetroit",altPopupClass:"esdmaps-alt-popup",altPopupOpenClass:"esdmaps-alt-popup-open",baseUrl:"//static.excellentschoolsdetroit.org/libs/esdmaps-js",selectedMarkerColor:"#124472"};b._presets={};var r=b.registerPreset=function(a,c){b._presets[a]=c},s=b.getPreset=function(a){return b._presets[a]};b.map=function(a,b,d){d=d||{};var g,h=s(b);return h?(d=e(d,f(h,["zoom","center","popupTemplate","pointsUrl","showPopupOnHover","hoverPopupTemplate"])),g=c.mapbox.map(a,h.mapboxId,d)):g=c.mapbox.map(a,b||q.mapboxId,d),k(g,d),d.pointsUrl&&l(g,d.pointsUrl,d),g};var t=b.detectMaps=function(){d(document.querySelectorAll(".esdmaps-map"),p)};return r("recommended-schools-k-8-2014",{mapboxId:q.mapboxId,center:c.latLng(42.3484,-83.058),zoom:13,pointsUrl:q.baseUrl+"/data/recommended-k-8-schools-2014-spring.json",popupTemplate:"<div><h2>{{schoolname}}</h2><p>{{grades}}<br>{{address}}<br>Call: {{phone}}<br><a href='{{scorecard-url}}' target='_blank'>See more detail</a></p></div>",showPopupOnHover:!0,hoverPopupTemplate:"<div class='hover-popup'><h2>{{schoolname}}</h2></div>"}),t(),b});
//# sourceMappingURL=esdmaps.min.map